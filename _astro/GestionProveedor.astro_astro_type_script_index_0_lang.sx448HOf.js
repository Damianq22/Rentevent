let m=[];async function l(){try{const e=await fetch("http://localhost:5183/api/Proveedores");e.ok?(m=await e.json(),g(m)):console.error("Error cargando proveedores:",e.statusText)}catch(e){console.error("Error:",e)}}function g(e){const a=document.getElementById("proveedorTable");a&&(a.innerHTML=e.map(t=>`
      <tr class="border-b bg-[#e9eef6] hover:bg-gray-50">
        <td class="w-4 p-4">
          <input type="checkbox" class="form-checkbox proveedorCheckbox" data-id="${t.id}" />
        </td>
        <td class="px-6 py-4 text-black font-semibold">${t.nombre}</td>
        <td class="px-6 py-4 text-black">${t.telefono}</td>
        <td class="px-6 py-4">
          <button class="text-blue-600 hover:text-blue-900 mr-3 editar-btn" data-id="${t.id}">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
            </svg>
          </button>
          <button class="text-red-600 hover:text-red-900 eliminar-btn" data-id="${t.id}">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
            </svg>
          </button>
        </td>
      </tr>
    `).join(""),document.querySelectorAll(".editar-btn").forEach(t=>{t.addEventListener("click",n=>{const r=n.currentTarget.dataset.id;r&&p(parseInt(r))})}),document.querySelectorAll(".eliminar-btn").forEach(t=>{t.addEventListener("click",n=>{const r=n.currentTarget.dataset.id;r&&E(parseInt(r))})}))}function h(){const e=document.getElementById("inputSearch");e&&e.addEventListener("input",a=>{const n=a.target.value.toLowerCase(),d=m.filter(r=>r.nombre.toLowerCase().includes(n)||r.telefono.toLowerCase().includes(n));g(d)})}function p(e){const a=m.find(s=>s.id===e);if(!a)return;const t=document.getElementById("editProveedorId"),n=document.getElementById("editProveedorNombre"),d=document.getElementById("editProveedorTelefono"),r=document.getElementById("modalEditar");t&&n&&d&&r&&(t.value=a.id.toString(),n.value=a.nombre,d.value=a.telefono,r.classList.remove("hidden"))}function E(e){console.log(e),confirm("¿Estás seguro de que deseas eliminar este proveedor?")&&b(e)}async function b(e){try{(await fetch(`http://localhost:5183/api/Proveedores/${e}`,{method:"DELETE"})).ok?(alert("Proveedor eliminado correctamente"),await l()):alert("Error al eliminar el proveedor")}catch(a){console.error("Error:",a),alert("Error al eliminar el proveedor")}}document.addEventListener("DOMContentLoaded",()=>{l(),h();const e=document.getElementById("modalAgregar"),a=document.getElementById("agregarProveedor"),t=document.getElementById("cancelarModal"),n=document.getElementById("cancelarModalEditar");a&&e&&a.addEventListener("click",()=>{e.classList.remove("hidden")}),t&&e&&t.addEventListener("click",()=>{e.classList.add("hidden")});const d=document.getElementById("modalEditar");n&&d&&n.addEventListener("click",()=>{d.classList.add("hidden")}),window.addEventListener("click",o=>{o.target===e&&o.target.classList.add("hidden"),o.target===d&&o.target.classList.add("hidden")});const r=document.getElementById("formAgregarProveedor");r&&r.addEventListener("submit",async o=>{o.preventDefault();const i=new FormData(r);try{(await fetch("http://localhost:5183/api/Proveedores",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nombre:i.get("nombre"),telefono:i.get("telefono")})})).ok?(alert("Proveedor agregado correctamente"),r.reset(),e&&e.classList.add("hidden"),await l()):alert("Error al agregar el proveedor")}catch(c){console.error("Error:",c),alert("Error al agregar el proveedor")}});const s=document.getElementById("formEditarProveedor");s&&s.addEventListener("submit",async o=>{o.preventDefault();const i=new FormData(s),c=i.get("id");try{(await fetch(`http://localhost:5183/api/Proveedores/${c}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:parseInt(c),nombre:i.get("nombre"),telefono:i.get("telefono")})})).ok?(alert("Proveedor actualizado correctamente"),d&&d.classList.add("hidden"),await l()):alert("Error al actualizar el proveedor")}catch(f){console.error("Error:",f),alert("Error al actualizar el proveedor")}});const u=document.getElementById("editarProveedor"),v=document.getElementById("eliminarProveedor");u&&u.addEventListener("click",()=>{const o=document.querySelector(".proveedorCheckbox:checked");o&&o.dataset.id?p(parseInt(o.dataset.id)):alert("Seleccione un proveedor para editar")}),v&&v.addEventListener("click",()=>{const o=document.querySelector(".proveedorCheckbox:checked");o&&o.dataset.id?E(parseInt(o.dataset.id)):alert("Seleccione un proveedor para eliminar")})});
